# Техническое Задание (ТЗ) на Систему Мониторинга Парковочного Пространства

## 1. Введение

Данное техническое задание описывает разработку системы мониторинга парковочного пространства с веб-интерфейсом на базе Flask. Система предназначена для эффективного управления парковочными местами с использованием видеонаблюдения и автоматизированного распознавания транспортных средств, при этом все данные будут храниться в локальных JSON-файлах без использования баз данных.

## 2. Цель Разработки

Создание упрощённой системы, которая позволяет:
- Управлять и мониторить парковочные места в реальном времени.
- Автоматически определять занятость парковочных мест с помощью видеокамер и алгоритмов распознавания.
- Обеспечивать удобный веб-интерфейс для настройки и наблюдения за состоянием парковки без необходимости использования логинов и паролей.
- Хранить всю текущую информацию в локальных JSON-файлах для упрощения архитектуры системы.

## 3. Область Применения

Система предназначена для использования на небольших парковках различных объектов, включая коммерческие здания, жилые комплексы, торговые центры и другие места, требующие контроля за занятостью парковочных мест.

## 4. Функциональные Требования

### 4.1. Управление Камерами

- Добавление Камер:
- Возможность добавления неограниченного количества камер.
- Для каждой камеры необходимо указать:
- Название.
- Ссылка на RTSP-поток.

- Назначение Камер:
- Каждая камера может быть назначена на одно или несколько парковочных пространств.

### 4.2. Управление Парковочными Пространствами

- Создание Парковочных Пространств:
- Возможность добавления неограниченного количества парковочных пространств.

- Назначение Камер к Парковочным Пространствам:
- Определение, какие камеры наблюдают за каким парковочным пространством.

### 4.3. Настройка Парковочных Мест

- Определение Парковочных Мест:
- Для каждого парковочного пространства необходимо определить:
1. Парковочные места.
2. Места, где парковаться запрещено.

- Нумерация:
- Парковочные и запрещённые места внутри парковочного пространства нумеруются последовательно.

- Настройка через Веб-интерфейс:
- В режиме настройки каждая камера должна предоставлять возможность:
- Создавать парковочные и запрещённые места.
- Перемещать их по изображению.

### 4.4. Режим Калибровки

- Автоматическое Определение Занятости:
- При обнаружении транспортного средства, стоящего на парковочном месте более 5 минут (интервал настраиваемый), место считается занятым.

- Нумерация Занятых Мест:
- Занятые парковочные места присваиваются сквозные номера.

### 4.5. Режим Работы

- Отображение Видеопотоков:
- Веб-интерфейс отображает видео с подключенных камер в реальном времени.

- Информация о Парковочных Местах:
- Для каждого парковочного пространства отображается:
- Количество свободных парковочных мест.
- Количество занятых парковочных мест.

- Обновление в Реальном Времени:
- Состояние парковочных мест обновляется мгновенно по мере изменений.

### 4.6. Алгоритм Распознавания Транспортных Средств

- Использование YOLOv12:
- Для определения наличия автомобиля на изображении применяется модель YOLOv12.

## 5. Нефункциональные Требования

### 5.1. Пользовательский Интерфейс

- Веб-интерфейс на Flask:
- Интуитивно понятный и удобный для пользователя.
- Отсутствие необходимости в аутентификации (логины и пароли не требуются).

### 5.2. Производительность

- Реальное Время:
- Система должна обрабатывать видеопотоки и обновлять информацию о парковочных местах в режиме реального времени.

### 5.3. Масштабируемость

- Умеренная Масштабируемость:
- Возможность добавления большого количества камер и парковочных пространств, учитывая ограниченность ресурсов при хранении данных в JSON-файлах.

### 5.4. Архитектура Системы

#### 5.4.1. Модуль Управления Камерами

- Управляет добавлением, назначением и конфигурацией камер, храня данные в JSON-файлах.

#### 5.4.2. Модуль Управления Парковочными Пространствами

Юрий Горелый, [18.06.2025 11:29]
- Обеспечивает создание и настройку парковочных пространств, а также парковочных и запрещённых мест, храня данные в JSON-файлах.

#### 5.4.3. Модуль Обработки Видеопотоков

- Принимает видеопотоки с камер, обрабатывает их с помощью YOLOv12 и определяет состояние парковочных мест.

#### 5.4.4. Веб-сервер и Интерфейс Пользователя

- Обеспечивает отображение видеопотоков и информации о парковочных местах в реальном времени через Flask.

## 6. Пользовательский Интерфейс

### 6.1. Режим Настройки

- Добавление Камер и Парковочных Пространств:
- Формы для ввода названия камеры и RTSP-ссылки.
- Интерфейс для создания парковочных пространств и назначения камер к ним.

- Настройка Парковочных Мест:
- Графический интерфейс для отображения видеопотока с возможностью создания и перемещения парковочных и запрещённых мест.

### 6.2. Режим Работы

- Обзор Видеопотоков:
- Дашборд с видеопотоками от всех камер.

- Статистика Парковочных Мест:
- Отображение количества занятых и свободных мест для каждого парковочного пространства.

- Интерактивные Элементы:
- Возможность выбора конкретного парковочного пространства для детального просмотра.

## 7. Алгоритмы и Методы

### 7.1. Распознавание Транспортных Средств

- YOLOv12:
- Используется для обнаружения автомобилей на видеопотоках.
- Обучение и настройка модели для повышения точности на конкретных условиях парковки.

### 7.2. Логика Определения Занятости

- Таймер Занятости:
- При обнаружении автомобиля на парковочном месте запускается таймер.
- Если автомобиль остается более заданного интервала (по умолчанию 5 минут), место считается занятым.

### 7.3. Нумерация Мест

- Сквозная Нумерация:
- Автоматическое присвоение номеров парковочным местам внутри каждого парковочного пространства.

## 8. Хранение и Обработка Данных

- Все данные о камерах, парковочных пространствах и состоянии парковочных мест сохраняются в локальных JSON-файлах с регулярным резервным копированием.

## 9. Управление Кодом

- Хранение Кода:
- Весь код проекта должен храниться в репозиториях на GitLab по адресу gitlab.bolid.ru.

## 10. План Внедрения

### 10.1. Этапы Разработки

1. Сбор требований и анализ.
2. Проектирование архитектуры системы.
3. Разработка модулей управления камерами и парковочными пространствами с использованием JSON для хранения данных.
4. Интеграция алгоритмов распознавания (YOLOv12).
5. Разработка веб-интерфейса на Flask.
6. Тестирование всех компонентов.
7. Внедрение и настройка на объекте.
8. Обучение пользователей и техническая поддержка.

### 10.2. Хранение Кода

- Весь исходный код должен быть загружен и управляться через систему контроля версий GitLab, доступную по адресу gitlab.bolid.ru.

## Заключение

Данное техническое задание определяет основные требования и функциональные возможности упрощённой системы мониторинга парковочного пространства на базе Flask с хранением данных в локальных JSON-файлах. Реализация данной системы позволит эффективно управлять парковочными ресурсами, обеспечивая при этом простоту разработки и эксплуатации.

# Краткие Рекомендации по Реализации

1. Flask Приложение:
- Использовать шаблоны Jinja2 для рендеринга веб-страниц.
- Организовать маршруты для разных режимов (настройка, работа).

2. Хранение Данных:
- Создать структуру JSON-файлов для хранения информации о камерах, парковочных пространствах и их состояниях.
- Реализовать функции для чтения и записи в эти файлы с учётом конкурентного доступа.

3. Обработка Видеопотоков:
- Использовать отдельные процессы или потоки для обработки RTSP-потоков и распознавания с помощью YOLOv12.
- Обновлять состояние парковочных мест в JSON-файлах на основе результатов распознавания.

4. Безопасность:
- Ограничить доступ к приложению по IP или другим механизмам, если необходимо.

5. Оптимизация:
- Учитывать производительность при работе с JSON-файлами, особенно при большом количестве данных.
- Рассмотреть возможность использования кеширования или других методов оптимизации доступа к данным.