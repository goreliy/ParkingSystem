# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã PyTorch 2.6 —Å YOLO –º–æ–¥–µ–ª—è–º–∏

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å YOLO –º–æ–¥–µ–ª—å –Ω–∞ PyTorch 2.6+ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:

```
AttributeError: 'str' object has no attribute '__module__'
```

–∏–ª–∏

```
WeightsUnpickler error: Unsupported global: GLOBAL ultralytics.nn.tasks.DetectionModel
```

### –ü—Ä–∏—á–∏–Ω–∞

PyTorch 2.6 –∏–∑–º–µ–Ω–∏–ª –ø–æ–ª–∏—Ç–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- –†–∞–Ω—å—à–µ: `torch.load(..., weights_only=False)` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –¢–µ–ø–µ—Ä—å: `torch.load(..., weights_only=True)` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- YOLO –º–æ–¥–µ–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç custom –∫–ª–∞—Å—Å—ã ‚Üí –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å `weights_only=True`

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û)

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–∞—Ç—á torch.load

–í —Ñ–∞–π–ª–µ `backend/app.py` –î–û –í–°–ï–• –∏–º–ø–æ—Ä—Ç–æ–≤ ultralytics –ø—Ä–∏–º–µ–Ω–µ–Ω –ø–∞—Ç—á:

```python
# –í –°–ê–ú–û–ú –ù–ê–ß–ê–õ–ï app.py
import os
os.environ['TORCH_FORCE_WEIGHTS_ONLY_LOAD'] = 'False'

import torch
_original_torch_load = torch.load

def _patched_torch_load(*args, **kwargs):
    """–ü–∞—Ç—á –¥–ª—è torch.load —Å weights_only=False."""
    kwargs['weights_only'] = False
    return _original_torch_load(*args, **kwargs)

torch.load = _patched_torch_load

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å ultralytics
from ultralytics import YOLO  # –ë—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?

- ‚úÖ YOLO –º–æ–¥–µ–ª–∏ –æ—Ç Ultralytics - –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö URL (GitHub releases)
- ‚úÖ –ü–∞—Ç—á –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```powershell
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:
python backend/app.py --host 0.0.0.0 --port 5000
```

**–í–ê–ñ–ù–û**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ! –ü–∞—Ç—á –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥–µ–ª–∏

–û—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
INFO - Ultralytics YOLO available
INFO - Loading YOLO model from yolov8n.pt
INFO - YOLO model loaded successfully: yolov8n.pt
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ - –æ—Ç–ª–∏—á–Ω–æ! ‚úÖ

### 3. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ª—é–±—ã–µ –º–æ–¥–µ–ª–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:5000/config`
2. –†–∞–∑–¥–µ–ª "ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ YOLO –º–æ–¥–µ–ª—è–º–∏"
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ **yolo11s.pt** (–Ω–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å")
4. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ—ë (–Ω–∞–∂–º–∏—Ç–µ "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å")
5. **–î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!**

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–∞—Ç—á —Ä–∞–±–æ—Ç–∞–µ—Ç

### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ UI:

```
1. Config ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ YOLO –º–æ–¥–µ–ª—è–º–∏
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å yolo11s.pt ‚Üí OK
3. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å yolo11s.pt ‚Üí OK (–±–µ–∑ –æ—à–∏–±–æ–∫!)
4. –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç yolo11s.pt
```

### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –ª–æ–≥–∏:

```
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
INFO - Changing YOLO model from yolov8n.pt to models\yolo11s.pt
INFO - Successfully changed to model: models\yolo11s.pt

–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
ERROR - Failed to change model to ...
AttributeError: 'str' object has no attribute '__module__'
```

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–∞—Ç—á –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫–∞—Ç PyTorch

```bash
pip install torch==2.5.0 --index-url https://download.pytorch.org/whl/cpu
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ultralytics

```bash
pip install --upgrade ultralytics
```

–ù–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ ultralytics –º–æ–≥—É—Ç –∏–º–µ—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è PyTorch 2.6.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ weights_only

–î–æ–±–∞–≤–∏—Ç—å –≤ `backend/services/detector.py` –ü–ï–†–ï–î –∏–º–ø–æ—Ä—Ç–æ–º YOLO:

```python
import torch
import torch.serialization

# –ì–ª–æ–±–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å weights_only (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
torch.serialization.DEFAULT_PROTOCOL = 'legacy'
```

---

## –í–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –¢–µ–∫—É—â–∏–µ (–∏–∑ requirements.txt):

```
Flask==3.0.0
ultralytics==8.1.0
opencv-python==4.8.1.78
torch (–≤–µ—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é PyTorch:

```python
import torch
print(torch.__version__)
```

–ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `2.6.x` - –ø–∞—Ç—á –Ω–µ–æ–±—Ö–æ–¥–∏–º –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω!

---

## –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** –≤ –≤–µ—Ä—Å–∏–∏ –æ—Ç 13.11.2025

**–§–∞–π–ª**: `backend/app.py` (—Å—Ç—Ä–æ–∫–∏ 4-18)

**–ü–∞—Ç—á –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è**: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–¢—Ä–µ–±—É–µ—Ç—Å—è**: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—á–∞

---

## –ò—Ç–æ–≥–∏

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–∞—Ç—á–µ–º:
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ YOLO –º–æ–¥–µ–ª–∏ (v8, v11)
- ‚úÖ –°–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å yolo11s.pt (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç –º–∞—à–∏–Ω—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!** üöÄ

