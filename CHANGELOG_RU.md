# –ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

## 2025-11-13 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

#### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ gevent/threading (–ò–°–ü–†–ê–í–õ–ï–ù–û)
- **–ü—Ä–æ–±–ª–µ–º–∞**: Gevent WSGIServer –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±–µ–∑ monkey patching, –≤—ã–∑—ã–≤–∞—è deadlock —Å –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ threading locks
- **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Flask threaded server
- **–§–∞–π–ª—ã**: `backend/app.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∑–∞–≤–∏—Å–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- **–ü—Ä–æ–±–ª–µ–º–∞**: Timeout –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ 10 —Å–µ–∫—É–Ω–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å—ã
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –£–º–µ–Ω—å—à–µ–Ω timeout —Å 10 –¥–æ 2 —Å–µ–∫—É–Ω–¥
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (>0.5s)
  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- **–§–∞–π–ª—ã**: `backend/storage/json_store.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö, –º–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∞–Ω–∏–π

#### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞–º–µ—Ä–∞—Ö
- **–†–µ—à–µ–Ω–∏–µ**:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ is_camera_alive –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º –∫–∞–¥—Ä–∞
  - –°–æ–∑–¥–∞—é—Ç—Å—è placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö (>1s)
- **–§–∞–π–ª—ã**: `backend/api/stream.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

#### 4. –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ç–∫–∏
- **–£–ª—É—á—à–µ–Ω–∏—è**:
  - –¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–æ–∫ —É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–æ 3px
  - –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 0.8
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∑–∞–ª–∏–≤–∫–∞ –∑–æ–Ω (30% –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å)
  - –¢–µ–∫—Å—Ç —Å —á–µ—Ä–Ω–æ–π –æ–±–≤–æ–¥–∫–æ–π –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–µ–≥–µ–Ω–¥–∞ —Ü–≤–µ—Ç–æ–≤ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
- **–§–∞–π–ª—ã**: `backend/api/stream.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–µ—Ç–∫–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –ø–∞—Ä–∫–æ–≤–æ—á–Ω—ã—Ö –º–µ—Å—Ç

#### 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- **–£–ª—É—á—à–µ–Ω–∏—è**:
  - –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–≤–µ–ª–∏—á–µ–Ω —Å 5 –¥–æ 10 —Å–µ–∫—É–Ω–¥
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - –ö–Ω–æ–ø–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
  - –ü–∞—É–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
- **–§–∞–π–ª—ã**: `backend/templates/dashboard.html`, `backend/templates/setup.html`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Graceful degradation, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

#### 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
- **–î–æ–±–∞–≤–ª–µ–Ω–æ**:
  - –°—á–µ—Ç—á–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ snapshot API
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - –°—Ä–µ–¥–Ω–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
  - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
  - Endpoint `/api/metrics` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å locks
- **–§–∞–π–ª—ã**: `backend/api/stream.py`, `backend/storage/json_store.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

#### Endpoint /api/metrics
```
GET /api/metrics

Response:
{
  "total_requests": 150,
  "successful": 145,
  "errors": 5,
  "camera_unavailable": 3,
  "encoding_errors": 0,
  "success_rate": "96.7%",
  "avg_response_time": "0.234s"
}
```

#### –¶–≤–µ—Ç–∞ —Ä–∞–∑–º–µ—Ç–∫–∏
- üü¢ –ó–µ–ª–µ–Ω—ã–π (0, 255, 0) - –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
- üî¥ –ö—Ä–∞—Å–Ω—ã–π (0, 0, 255) - –ó–∞–Ω—è—Ç–æ–µ –º–µ—Å—Ç–æ  
- üîµ –°–∏–Ω–∏–π (255, 0, 0) - –ó–æ–Ω–∞ –∑–∞–ø—Ä–µ—Ç–∞ –ø–∞—Ä–∫–æ–≤–∫–∏

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Timeout —Ñ–∞–π–ª–æ–≤—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫: 2 —Å–µ–∫—É–Ω–¥—ã
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ >0.5s
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ snapshot >1.0s
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- –ü–∞—É–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ** —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 5-10 —Å–µ–∫—É–Ω–¥ –ø–æ–∫–∞ –∫–∞–º–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è
2. **–ï—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞** –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω placeholder —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º
3. **–ú–µ—Ç—Ä–∏–∫–∏** –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:5000/api/metrics`
4. **–õ–æ–≥–∏** –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤ `logs/parking.log` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ Windows 10/11
- ‚úÖ Linux (Ubuntu 20.04+)
- ‚úÖ Python 3.10+
- ‚úÖ –í—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ES6

